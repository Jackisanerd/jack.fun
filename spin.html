<!DOCTYPE html>
<html lang="en">
<head>
<link rel="icon" href="https://wheelofnames.com/images/open-graph-image.png"image/png"><meta charset="UTF-8">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interlude Wheel</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Segoe UI', Roboto, system-ui, sans-serif;
    }
    body {
      background: linear-gradient(145deg, #f0f2f5 0%, #e0e5ec 100%);
      min-height: 100vh;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }
    .card {
      max-width: 1000px;
      width: 100%;
      background: rgba(255,255,255,0.6);
      backdrop-filter: blur(4px);
      border-radius: 48px;
      box-shadow: 20px 20px 40px #b8b9be, -20px -20px 40px #ffffff;
      padding: 30px 30px 40px;
    }
    h1 {
      text-align: center;
      font-weight: 600;
      font-size: 2.2rem;
      margin: 0 0 10px;
      color: #1e2b3a;
      letter-spacing: -0.5px;
    }
    .sub {
      text-align: center;
      margin: 0 0 25px;
      color: #3a4a5a;
      font-weight: 400;
    }
    .wheel-container {
      position: relative;
      width: min(70vw, 600px);
      height: min(70vw, 600px);
      margin: 0 auto 25px;
    }
    canvas {
      width: 100% !important;
      height: 100% !important;
      display: block;
      border-radius: 50%;
      box-shadow: 0 20px 30px rgba(0,0,0,0.2), inset 0 0 10px rgba(255,255,255,0.5);
      cursor: pointer;
      transition: filter 0.2s;
      background: #fafafa;
    }
    canvas:active {
      filter: brightness(0.98);
    }
    .pointer {
      position: absolute;
      top: -8px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 22px solid transparent;
      border-right: 22px solid transparent;
      border-top: 40px solid #c5283d;
      filter: drop-shadow(0 6px 4px rgba(0,0,0,0.2));
      z-index: 5;
    }
    .action-bar {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
      margin: 20px 0 25px;
      flex-wrap: wrap;
    }
    .result-badge {
      background: #2c3e50;
      color: white;
      padding: 12px 30px;
      border-radius: 60px;
      font-size: 1.5rem;
      font-weight: 600;
      box-shadow: inset 0 -3px 0 #1a2632, 0 8px 12px rgba(0,0,0,0.1);
      min-width: 200px;
      text-align: center;
    }
    button {
      background: #ffffff;
      border: none;
      padding: 12px 28px;
      border-radius: 40px;
      font-size: 1.2rem;
      font-weight: 600;
      color: #1e2b3a;
      box-shadow: 5px 5px 15px #b8b9be, -5px -5px 15px #ffffff;
      cursor: pointer;
      transition: 0.1s ease;
      border: 1px solid rgba(255,255,255,0.4);
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    button:hover {
      box-shadow: 2px 2px 8px #b8b9be, -2px -2px 8px #ffffff;
    }
    button:active {
      transform: scale(0.97);
    }
    button:disabled {
      opacity: 0.4;
      pointer-events: none;
    }
    .go-button {
      background: #27ae60;
      color: white;
      box-shadow: 5px 5px 15px #1e8449, -5px -5px 15px #2ecc71;
    }
    .editor-panel {
      background: rgba(255,255,255,0.4);
      backdrop-filter: blur(4px);
      border-radius: 40px;
      padding: 25px;
      box-shadow: inset 2px 2px 6px #b8b9be, inset -3px -3px 8px #ffffff, 0 10px 15px rgba(0,0,0,0.05);
    }
    .editor-panel h3 {
      margin: 0 0 15px;
      font-weight: 500;
      color: #1e2b3a;
    }
    .interlude-list {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 25px;
      max-height: 180px;
      overflow-y: auto;
      padding: 8px 4px;
    }
    .interlude-tag {
      background: white;
      padding: 8px 16px;
      border-radius: 40px;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 2px 2px 5px #b8b9be, -2px -2px 5px #ffffff;
      font-size: 0.9rem;
    }
    .interlude-tag .name {
      font-weight: 600;
      max-width: 150px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .remove-btn {
      background: none;
      border: none;
      color: #a00;
      font-weight: bold;
      font-size: 1.2rem;
      cursor: pointer;
      padding: 0 4px;
      box-shadow: none;
    }
    .add-form {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
    }
    .add-form input {
      flex: 1 1 200px;
      padding: 12px 18px;
      border: none;
      border-radius: 40px;
      background: #f0f2f5;
      box-shadow: inset 3px 3px 8px #b8b9be, inset -3px -3px 8px #ffffff;
      font-size: 1rem;
      outline: none;
    }
    .add-form input:focus {
      background: #ffffff;
    }
    .small-note {
      font-size: 0.8rem;
      color: #3a4a5a;
      margin: 8px 0 0;
      opacity: 0.8;
    }
  </style>
</head>
<body>
<div class="card">
  <h1>üé≤ INTERLUDE WHEEL</h1>
  <div class="sub">click the wheel to spin ‚Ä¢ then use the GO button</div>

  <div class="wheel-container">
    <canvas id="wheelCanvas" width="600" height="600"></canvas>
    <div class="pointer"></div>
  </div>

  <!-- clearer action bar -->
  <div class="action-bar">
    <div class="result-badge" id="resultDisplay">‚ú® spin me</div>
    <button id="goBtn" class="go-button" disabled>‚ñ∂ GO</button>
  </div>

  <!-- editable list of interludes -->
  <div class="editor-panel">
    <h3>‚úèÔ∏è edit interludes (add / remove)</h3>
    <div class="interlude-list" id="interludeListContainer"></div>
    <div class="add-form">
      <input type="text" id="newName" placeholder="name e.g. 'hot interlude'" />
      <input type="text" id="newLink" placeholder="url (or comma separated, leave blank if none)" />
      <button id="addInterludeBtn">‚ûï add</button>
    </div>
    <div class="small-note">
      ‚Ä¢ for multiple urls, separate with commas (e.g. https://a.com, https://b.com)<br>
      ‚Ä¢ leave link empty for interludes like "Call Kai"
    </div>
  </div>
</div>

<script>
(function() {
  // ---- initial interlude data ----
  const initialInterludes = [
    { name: "hot interlude", link: "https://www.reddit.com/r/JackSucksAtLife/hot/" },
    { name: "Geography Interlude", link: ["https://worldle.teuteuf.fr/", "https://www.flaggle.net/", "https://globle-game.com/"] },
    { name: "jackle interlude", link: "https://jackisanerd.github.io/Jackle/" },
    { name: "higher or lower interlude", link: "https://jackisanerd.github.io/HigherOrLower/" },
    { name: "jack.fun interlude", link: "https://jackisanerd.github.io/jack.fun/" },
    { name: "Call Kai", link: null },
    { name: "new interlude", link: "https://www.reddit.com/r/JackSucksAtLife/new/" },
    { name: "r/JSAG interlude", link: "https://www.reddit.com/r/JackSucksAtGeography/" },
    { name: "Sitting in the front seat", link: "https://www.reddit.com/r/JackSucksAtLife/comments/1pw2rnj/jack_again_do_it_again_revive_sitting_in_the/" },
    { name: "complete a promise", link: null },
    { name: "Hall of Fame interlude", link: ["https://jackisanerd.github.io/jack.fun/JHOF.html", "https://jsalhof.wixsite.com/reddit/halloffame"] },
    { name: "fan subreddit", link: ["https://www.reddit.com/r/PWKFanClub/", "https://www.reddit.com/r/weeweebush/", "https://www.reddit.com/r/peepeetree/"] }
  ];

  let interludes = [];
  let segments = [];
  let currentRotation = 0;
  let spinVelocity = 0;
  let spinAnimationFrame = null;
  let isSpinning = false;
  let currentResultIndex = -1;
  const pointerAngle = -Math.PI / 2; // 12 o'clock

  // DOM elements
  const canvas = document.getElementById('wheelCanvas');
  const ctx = canvas.getContext('2d');
  const resultDisplay = document.getElementById('resultDisplay');
  const goBtn = document.getElementById('goBtn');
  const interludeListContainer = document.getElementById('interludeListContainer');
  const newNameInput = document.getElementById('newName');
  const newLinkInput = document.getElementById('newLink');
  const addBtn = document.getElementById('addInterludeBtn');

  // helper: short name for wheel
  function shortNameFrom(name) {
    if (name.length <= 14) return name;
    let words = name.split(' ');
    if (words[0].length < 10) return words[0];
    return name.substring(0, 12) + '‚Ä¶';
  }

  // rebuild segments from interludes
  function rebuildSegments() {
    segments = interludes.map((item, idx) => {
      const short = shortNameFrom(item.name);
      const hue = (idx * 37) % 360;
      const color = `hsl(${hue}, 70%, 75%)`;
      return { name: item.name, short, color, link: item.link };
    });
  }

  // initial load
  function loadInitial() {
    interludes = initialInterludes.map(item => ({
      name: item.name,
      link: Array.isArray(item.link) ? [...item.link] : item.link
    }));
    rebuildSegments();
  }
  loadInitial();

  // draw wheel
  function drawWheel(highlightIndex = -1) {
    const width = canvas.width;
    const height = canvas.height;
    const centerX = width / 2;
    const centerY = height / 2;
    const radius = Math.min(width, height) * 0.42;

    ctx.clearRect(0, 0, width, height);

    if (segments.length === 0) {
      ctx.font = 'bold 20px "Segoe UI"';
      ctx.fillStyle = '#aaa';
      ctx.textAlign = 'center';
      ctx.fillText('no interludes', centerX, centerY);
      return;
    }

    const anglePerSegment = (2 * Math.PI) / segments.length;

    for (let i = 0; i < segments.length; i++) {
      const startAngle = i * anglePerSegment + currentRotation;
      const endAngle = startAngle + anglePerSegment;

      ctx.beginPath();
      ctx.moveTo(centerX, centerY);
      ctx.arc(centerX, centerY, radius, startAngle, endAngle);
      ctx.closePath();
      ctx.fillStyle = segments[i].color;
      if (i === highlightIndex && !isSpinning) {
        ctx.shadowColor = 'gold';
        ctx.shadowBlur = 15;
        ctx.fill();
        ctx.shadowBlur = 0;
      } else {
        ctx.fill();
      }
      ctx.strokeStyle = '#ffffff';
      ctx.lineWidth = 1.5;
      ctx.stroke();

      ctx.save();
      ctx.translate(centerX, centerY);
      ctx.rotate(startAngle + anglePerSegment / 2);
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.font = 'bold 16px "Segoe UI", sans-serif';
      ctx.fillStyle = '#1e2b3a';
      ctx.shadowColor = 'rgba(255,255,255,0.5)';
      ctx.shadowBlur = 4;
      ctx.fillText(segments[i].short, radius * 0.7, 0);
      ctx.restore();
    }

    ctx.beginPath();
    ctx.arc(centerX, centerY, radius * 0.12, 0, 2 * Math.PI);
    ctx.fillStyle = '#f0f2f5';
    ctx.shadowBlur = 8;
    ctx.shadowColor = '#b8b9be';
    ctx.fill();
    ctx.shadowBlur = 0;
    ctx.strokeStyle = '#ccc';
    ctx.lineWidth = 2;
    ctx.stroke();
  }

  // get segment under pointer
  function getCurrentSegmentIndex() {
    if (segments.length === 0) return -1;
    let rawAngle = pointerAngle - currentRotation;
    rawAngle = ((rawAngle % (2 * Math.PI)) + 2 * Math.PI) % (2 * Math.PI);
    const anglePer = (2 * Math.PI) / segments.length;
    return Math.floor(rawAngle / anglePer);
  }

  // spin animation
  function spinWheel() {
    if (isSpinning) return;
    isSpinning = true;
    currentResultIndex = -1;
    goBtn.disabled = true;
    resultDisplay.innerText = 'üåÄ spinning...';
    spinVelocity = 15 + Math.random() * 25;
    const friction = 0.97;

    function animate() {
      if (!isSpinning) return;
      currentRotation += spinVelocity * 0.02;
      spinVelocity *= friction;
      drawWheel();

      if (Math.abs(spinVelocity) < 0.05) {
        isSpinning = false;
        const landedIdx = getCurrentSegmentIndex();
        currentResultIndex = landedIdx;
        const landedName = segments[landedIdx]?.name || '???';
        resultDisplay.innerText = `üéØ ${landedName}`;
        drawWheel(landedIdx);
        goBtn.disabled = false; // enable GO button
      } else {
        spinAnimationFrame = requestAnimationFrame(animate);
      }
    }
    spinAnimationFrame = requestAnimationFrame(animate);
  }

  // open link for current result
  function goToCurrentInterlude() {
    if (currentResultIndex < 0 || currentResultIndex >= interludes.length) {
      alert('No interlude selected ‚Äì spin first!');
      return;
    }
    const interlude = interludes[currentResultIndex];
    const link = interlude.link;

    if (!link) {
      alert(`"${interlude.name}" has no website. Maybe it's a challenge!`);
      return;
    }

    if (Array.isArray(link)) {
      if (link.length === 0) {
        alert('No links available.');
        return;
      }
      const randomLink = link[Math.floor(Math.random() * link.length)];
      window.open(randomLink, '_blank');
    } else {
      window.open(link, '_blank');
    }
  }

  // reset to idle
  function resetSpinState() {
    if (isSpinning) {
      cancelAnimationFrame(spinAnimationFrame);
      isSpinning = false;
    }
    currentResultIndex = -1;
    goBtn.disabled = true;
    resultDisplay.innerText = '‚ú® spin me';
    drawWheel();
  }

  // ---- event listeners ----
  canvas.addEventListener('click', () => {
    if (segments.length === 0) {
      alert('Add some interludes first!');
      return;
    }
    if (!isSpinning) {
      spinWheel(); // wheel click always spins
    }
  });

  goBtn.addEventListener('click', goToCurrentInterlude);

  // ---- interlude list management ----
  function renderInterludeList() {
    let html = '';
    interludes.forEach((item, idx) => {
      let linkSummary = '';
      if (item.link === null) linkSummary = 'üö´ no url';
      else if (Array.isArray(item.link)) linkSummary = `üîó ${item.link.length} urls`;
      else linkSummary = 'üîó url';
      html += `<div class="interlude-tag">
        <span class="name" title="${item.name}">${item.name}</span>
        <span style="font-size:0.8rem;opacity:0.8;">${linkSummary}</span>
        <button class="remove-btn" data-index="${idx}">‚úï</button>
      </div>`;
    });
    interludeListContainer.innerHTML = html;

    document.querySelectorAll('.remove-btn').forEach(btn => {
      btn.addEventListener('click', (e) => {
        const index = parseInt(e.target.getAttribute('data-index'), 10);
        if (!isNaN(index) && index >= 0 && index < interludes.length) {
          interludes.splice(index, 1);
          rebuildSegments();
          resetSpinState();
          renderInterludeList();
        }
      });
    });
  }

  function addInterlude() {
    const name = newNameInput.value.trim();
    if (!name) {
      alert('Please enter a name');
      return;
    }
    const linkInput = newLinkInput.value.trim();
    let link = null;
    if (linkInput !== '') {
      if (linkInput.includes(',')) {
        link = linkInput.split(',').map(s => s.trim()).filter(s => s.startsWith('http'));
        if (link.length === 0) link = null;
      } else {
        link = linkInput;
      }
    }
    interludes.push({ name, link });
    rebuildSegments();
    resetSpinState();
    renderInterludeList();
    newNameInput.value = '';
    newLinkInput.value = '';
  }

  addBtn.addEventListener('click', addInterlude);
  newLinkInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') addInterlude(); });
  newNameInput.addEventListener('keypress', (e) => { if (e.key === 'Enter') addInterlude(); });

  // initial render
  renderInterludeList();
  drawWheel();
})();
</script>
</body>
</html>